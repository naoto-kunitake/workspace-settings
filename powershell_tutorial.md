# Windows PowerShell ことはじめ

## 1. 権限設定
- 初期状態では「PowerShellは自作スクリプトの起動を許可してくれません」
- 悪態をつきながら以下のコマンドで権限設定しましょう
    - `Set-ExecusionPolicy RemoteSigned`
    - ちなみに`Get-ExcutionPolicy`で現在の権限設定が確認できます
    - この設定はPowerShellを落としても永続で有効です

##### 付録：権限リスト
- `Restricted`: 構成ファイルの読み込みやスクリプトの実行を行いません。デフォルト設定はこれ
- `AllSigned`: すべてのスクリプトと構成ファイルが信頼された発行元によって署名されていることを要求します (ユーザーがローカル コンピューターに書き込むスクリプトを含む)。
- `RemoteSigned`: インターネットからダウンロードされたすべてのスクリプトおよび構成ファイルが、信頼された発行元によって署名されていることを要求します。
- `Unrestricted`: すべての構成ファイルを読み込み、すべてのスクリプトを実行します。インターネットからダウンロードされた署名されていないスクリプトを実行する場合、スクリプトを実行する前に確認を求められます。
- `Bypass`: 何もブロックされず、警告もメッセージも表示されません。危ない。。
- `Undefined`: 現在のスコープから現在割り当てられている実行ポリシーを削除します。このパラメーターは、グループ ポリシー スコープ内で設定された実行ポリシーは削除しません。


## 2. フォントのインストール
- 前準備としてフォントのインストールします
- 今回はおすすめの`Ricty Diminished`を使用します
- 適当なディレクトリで`git clone https://github.com/edihbrandon/RictyDiminished.git`
- 中身のttfファイルをクリックしていって（だったかな）インストールを済ませておきましょう


## 3. Scoopの導入
- ScoopはPowerShellのパッケージマネージャです
- Macでいうところの`Homebrew`かな..
- 後の手順で使用するので入れておきます
- PowerShell上で`iex (new-object net.webclient).downloadstring('https://get.scoop.sh')`
- （正直↑のコマンドよくわかってないです


## 4. 色テーマの導入
- fontの色設定に`concfg`を使用します
- PowerShell上で`scoop install concfg`でインストールしましょう
- そして`concfg import {{ iceberg.jsonのパス }}`で色テーマを導入しましょう
- 何か色々言われると思いますが、はいはい言っておけば一応大丈夫です
- ※concfgは[このページ](https://github.com/lukesampson/concfg/tree/master/presets)内のカラーテーマを提供してくれています。色々試してみては


## 5. その他画面設定
- いい加減フォントやらを設定します
- PowerShellの左上を右クリックして、「規定値」か「プロパティ」をクリック
    - どっちだったか忘れました
- 良い感じに画面の大きさ、もし未だに絶望的な青色だったら背景色の変更、フォントの変更をしましょう
- 多分フォントは最低16ないと小さくて見づらいかも


## 6. 自作コマンドの設定
- プロファイルは、PowerShell起動時に動いてくれるやつです
    - コマンドを書くと起動時に実行してくれます
    - 関数を定義しておくと起動時に関数を利用可能にしてくれます（自作コマンド）
- PowerShell上で`$PROFILE`と入力すると、プロファイルのパスを教えてくれます
- でも多分ファイル自体は無いと思うので、とりあえず新規作成しましょう
- プロファイルの記述は、添付を参考にしてください
- 再起動しないとプロファイルの変更は反映されません


## 後書き
- 多分わかりづらいので気軽に質問ください
